/*
* Kendo UI Web v2012.2.710 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Web commercial licenses may be obtained at http://kendoui.com/web-license
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3.
* For GPL requirements, please review: http://www.gnu.org/copyleft/gpl.html
*/
;(function(a,b){function P(b){b=a(b),b.filter(".k-first:not(:first-child)").removeClass(t),b.filter(".k-last:not(:last-child)").removeClass(p),b.filter(":first-child").addClass(t),b.filter(":last-child").addClass(p)}function O(b){b=a(b),b.find(".k-icon").remove(),b.filter(":has(.k-group)").children(".k-link:not(:has([class*=k-i-arrow]))").each(function(){var b=a(this),c=b.parent().parent();b.append("<span class='k-icon "+(c.hasClass(n+"-horizontal")?"k-i-arrow-s":"k-i-arrow-e")+"'/>")})}function N(b){b=a(b),b.addClass("k-item").children(l).addClass(u),b.children("a").addClass(o).children(l).addClass(u),b.filter(":not([disabled])").addClass(A),b.filter(".k-separator:empty").append("&nbsp;"),b.filter("li[disabled]").addClass(B).removeAttr("disabled"),b.children("a").filter(":focus").parent().addClass("k-state-active"),b.children("."+o).length||b.contents().filter(function(){return!this.nodeName.match(k)&&(this.nodeType!=3||!!a.trim(this.nodeValue))}).wrapAll("<span class='"+o+"'/>"),O(b),P(b)}function M(b,c){try{return a.contains(b,c)}catch(d){return!1}}function L(a,b){a=a.split(" ")[!b+0]||a;var d={origin:["bottom","left"],position:["top","left"]},e=/left|right/.test(a);e?(d.origin=["top",a],d.position[1]=c.directions[a].reverse):(d.origin[0]=a,d.position[0]=c.directions[a].reverse),d.origin=d.origin.join(" "),d.position=d.position.join(" ");return d}function K(a,b){a=a.split(" ")[!b+0]||a;return a.replace("top","up").replace("bottom","down")}var c=window.kendo,d=c.ui,e=c.support.touch,f=a.extend,g=a.proxy,h=a.each,i=c.template,j=d.Widget,k=/^(ul|a|div)$/i,l="img",m="open",n="k-menu",o="k-link",p="k-last",q="close",r=e?"touchend":"click",s="timer",t="k-first",u="k-image",v="select",w="zIndex",x="mouseenter",y="mouseleave",z="kendoPopup",A="k-state-default",B="k-state-disabled",C=".k-group",D=":not(.k-list) > .k-item",E=".k-item.k-state-disabled",F=".k-item:not(.k-state-disabled)",G=".k-item:not(.k-state-disabled) > .k-link",H="div:not(.k-animation-container,.k-list-container)",I={content:i("<div class='k-content k-group'>#= content(item) #</div>"),group:i("<ul class='#= groupCssClass(group) #'#= groupAttributes(group) #>#= renderItems(data) #</ul>"),itemWrapper:i("<#= tag(item) # class='#= textClass(item) #'#= textAttributes(item) #>#= image(item) ##= sprite(item) ##= text(item) ##= arrow(data) #</#= tag(item) #>"),item:i("<li class='#= wrapperCssClass(group, item) #'>#= itemWrapper(data) ## if (item.items) { ##= subGroup({ items: item.items, menu: menu, group: { expanded: item.expanded } }) ## } #</li>"),image:i("<img class='k-image' alt='' src='#= imageUrl #' />"),arrow:i("<span class='#= arrowClass(item, group) #'></span>"),sprite:i("<span class='k-sprite #= spriteCssClass #'></span>"),empty:i("")},J={wrapperCssClass:function(a,b){var c="k-item",d=b.index;b.enabled===!1?c+=" k-state-disabled":c+=" k-state-default",a.firstLevel&&d===0&&(c+=" k-first"),d==a.length-1&&(c+=" k-last");return c},textClass:function(a){return o},textAttributes:function(a){return a.url?" href='"+a.url+"'":""},arrowClass:function(a,b){var c="k-icon";b.horizontal?c+=" k-i-arrow-s":c+=" k-i-arrow-e";return c},text:function(a){return a.encoded===!1?a.text:c.htmlEncode(a.text)},tag:function(a){return a.url?"a":"span"},groupAttributes:function(a){return a.expanded!==!0?" style='display:none'":""},groupCssClass:function(a){return"k-group"},content:function(a){return a.content?a.content:"&nbsp;"}},Q=j.extend({init:function(b,d){var f=this;j.fn.init.call(f,b,d),b=f.wrapper=f.element,d=f.options,d.dataSource&&(f.element.empty(),f.append(d.dataSource,b)),f._updateClasses(),d.animation===!1&&(d.animation={open:{show:!0,effects:{}},close:{hide:!0,effects:{}}}),f.nextItemZIndex=100,b.delegate(E,r,!1).delegate(F,r,g(f._click,f)),e?(d.openOnClick=!0,b.delegate(G,"touchstart touchend",f._toggleHover)):b.delegate(F,x,g(f._mouseenter,f)).delegate(F,y,g(f._mouseleave,f)).delegate(G,x+" "+y,f._toggleHover),d.openOnClick&&(f.clicked=!1,a(document).click(g(f._documentClick,f))),c.notify(f)},events:[m,q,v],options:{name:"Menu",animation:{open:{duration:200,show:!0},close:{duration:100}},orientation:"horizontal",direction:"default",openOnClick:!1,closeOnClick:!0,hoverDelay:100},enable:function(a,b){this._toggleDisabled(a,b!==!1);return this},disable:function(a){this._toggleDisabled(a,!1);return this},append:function(b,c){c=this.element.find(c);var d=this._insert(b,c,c.length?c.find("> .k-group, .k-animation-container > .k-group"):null);h(d.items,function(b){d.group.append(this);var c=d.contents[b];c&&a(this).append(c),O(this)}),O(c),P(d.group.find(".k-first, .k-last").add(d.items));return this},insertBefore:function(b,c){c=this.element.find(c);var d=this._insert(b,c,c.parent());h(d.items,function(b){c.before(this);var e=d.contents[b];e&&a(this).append(e),O(this),P(this)}),P(c);return this},insertAfter:function(b,c){c=this.element.find(c);var d=this._insert(b,c,c.parent());h(d.items,function(b){c.after(this);var e=d.contents[b];e&&a(this).append(e),O(this),P(this)}),P(c);return this},_insert:function(b,c,d){var e=this,g,h,i=[];if(!c||!c.length)d=e.element;var j=a.isPlainObject(b),k={firstLevel:d.hasClass(n),horizontal:d.hasClass(n+"-horizontal"),expanded:!0,length:d.children().length};c&&!d.length&&(d=a(Q.renderGroup({group:k})).appendTo(c)),j||a.isArray(b)?(g=a.map(j?[b]:b,function(b,c){return typeof b=="string"?a(b):a(Q.renderItem({group:k,item:f(b,{index:c})}))}),i=a.map(j?[b]:b,function(b,c){return b.content||b.contentUrl?a(Q.renderContent({item:f(b,{index:c})})):!1})):(g=a(b),h=g.find("> ul").addClass("k-group"),g=g.filter("li"),g.add(h.find("> li")).each(function(){N(this)}));return{items:g,group:d,contents:i}},remove:function(a){a=this.element.find(a);var b=this,c=a.parentsUntil(b.element,D),d=a.parent("ul");a.remove();if(d&&!d.children(D).length){var e=d.parent(".k-animation-container");e.length?e.remove():d.remove()}c.length&&(c=c.eq(0),O(c),P(c));return b},open:function(c){var d=this,e=d.options,g=e.orientation=="horizontal",h=e.direction;c=d.element.find(c),/^(top|bottom|default)$/.test(h)&&(h=g?(h+" right").replace("default","bottom"):"right"),c.siblings().find(">.k-popup:visible,>.k-animation-container>.k-popup:visible").each(function(){var b=a(this).data("kendoPopup");b&&b.close()}),c.each(function(){var c=a(this);clearTimeout(c.data(s)),c.data(s,setTimeout(function(){var a=c.find(".k-group:first:hidden"),i;if(a[0]&&d.trigger(m,{item:c[0]})===!1){c.data(w,c.css(w)),c.css(w,d.nextItemZIndex++),i=a.data(z);var j=c.parent().hasClass(n),k=j&&g,l=L(h,j),o=e.animation.open.effects,p=o!==b?o:"slideIn:"+K(h,j);i?(i=a.data(z),i.options.origin=l.origin,i.options.position=l.position,i.options.animation.open.effects=p):i=a.kendoPopup({origin:l.origin,position:l.position,collision:e.popupCollision!==b?e.popupCollision:k?"fit":"fit flip",anchor:c,appendTo:c,animation:{open:f(!0,{effects:p},e.animation.open),close:e.animation.close},close:function(a){var b=a.sender.wrapper.parent();d.trigger(q,{item:b[0]})===!1?(b.css(w,b.data(w)),b.removeData(w)):a.preventDefault()}}).data(z),i.open()}},d.options.hoverDelay))});return d},close:function(b){var c=this;b=c.element.find(b),b[0]||(b=c.element.find(">.k-item")),b.each(function(){var b=a(this);clearTimeout(b.data(s)),b.data(s,setTimeout(function(){var a=b.find(".k-group:first:visible"),c;a[0]&&(c=a.data(z),c.close())},c.options.hoverDelay))});return c},_toggleDisabled:function(b,c){b=this.element.find(b),b.each(function(){a(this).toggleClass(A,c).toggleClass(B,!c)})},_toggleHover:function(b){var d=a(c.eventTarget(b)).closest(D);d.parents("li."+B).length||d.toggleClass("k-state-hover",b.type==x||b.type=="touchstart")},_updateClasses:function(){var a=this;a.element.addClass("k-widget k-reset k-header "+n).addClass(n+"-"+a.options.orientation);var b=a.element.find("li > ul").addClass("k-group").end().find("> li,.k-group > li");b.each(function(){N(this)})},_mouseenter:function(b){var c=this,d=a(b.currentTarget),e=d.children(".k-animation-container").length||d.children(C).length;b.delegateTarget==d.parents(".k-menu")[0]&&((!c.options.openOnClick||c.clicked)&&!M(b.currentTarget,b.relatedTarget)&&e&&c.open(d),c.options.openOnClick&&c.clicked&&d.siblings().each(g(function(a,b){c.close(b)},c)))},_mouseleave:function(b){var c=this,d=a(b.currentTarget),e=d.children(".k-animation-container").length||d.children(C).length;d.parentsUntil(".k-animation-container",".k-list-container,.k-calendar-container")[0]?b.stopImmediatePropagation():!c.options.openOnClick&&!M(b.currentTarget,b.relatedTarget)&&e&&c.close(d)},_click:function(b){var d=this,f,h=a(c.eventTarget(b)),i=h.closest("."+o),j=i.attr("href"),k=h.closest(D),l=!!j&&j.charAt(j.length-1)!="#";if(!k.children(H)[0]){if(k.hasClass(B)){b.preventDefault();return}e&&k.siblings().each(g(function(a,b){d.close(b)},d)),!b.handled&&d.trigger(v,{item:k[0]})&&b.preventDefault(),b.handled=!0,d.options.closeOnClick&&!(j&&j.length>0)&&!k.children(C+",.k-animation-container").length&&d.close(i.parentsUntil(d.element,D));if((!k.parent().hasClass(n)||!d.options.openOnClick)&&!e)return;l||b.preventDefault(),d.clicked=!0,f=k.children(".k-animation-container, .k-group").is(":visible")?q:m,d[f](k)}},_documentClick:function(a){var b=this;M(b.element[0],a.target)||(b.clicked=!1)}});f(Q,{renderItem:function(a){a=f({menu:{},group:{}},a);var b=I.empty,c=a.item;return I.item(f(a,{image:c.imageUrl?I.image:b,sprite:c.spriteCssClass?I.sprite:b,itemWrapper:I.itemWrapper,arrow:c.items||c.content?I.arrow:b,subGroup:Q.renderGroup},J))},renderGroup:function(a){return I.group(f({renderItems:function(a){var b="",c=0,d=a.items,e=d?d.length:0,g=f({length:e},a.group);for(;c<e;c++)b+=Q.renderItem(f(a,{group:g,item:f({index:c},d[c])}));return b}},a,J))},renderContent:function(a){return I.content(f(a,J))}}),c.ui.plugin(Q)})(jQuery);