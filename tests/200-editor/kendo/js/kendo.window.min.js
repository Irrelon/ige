/*
* Kendo UI Web v2012.2.710 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Web commercial licenses may be obtained at http://kendoui.com/web-license
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3.
* For GPL requirements, please review: http://www.gnu.org/copyleft/gpl.html
*/
;(function(a,b){function Q(a){var b=this;b.owner=a,b._draggable=new e(a.wrapper,{filter:n,group:a.wrapper.id+"-moving",dragstart:g(b.dragstart,b),drag:g(b.drag,b),dragend:g(b.dragend,b),dragcancel:g(b.dragcancel,b)})}function P(a){var b=this;b.owner=a,b._draggable=new e(a.wrapper,{filter:p,group:a.wrapper.id+"-resizing",dragstart:g(b.dragstart,b),drag:g(b.drag,b),dragend:g(b.dragend,b)})}function N(a,b){return function(){var a=this,c=a.wrapper,d=c[0].style,e=a.options;if(!e.isMaximized&&!e.isMinimized){a.restoreOptions={width:d.width,height:d.height},c.find(p).hide().end().find(I).parent().hide().eq(0).before(l.action({name:"Restore"})),b.call(a);return a}}}function M(){return a(m).filter(function(){var b=a(this);return b.is(u)&&L(b).options.modal}).sort(function(b,c){return+a(b).css("zIndex")- +a(c).css("zIndex")})}function L(a){return a.children(o).data("kendoWindow")}function K(a,b,c){return Math.max(Math.min(a,c),b)}var c=window.kendo,d=c.ui.Widget,e=c.ui.Draggable,f=a.isPlainObject,g=a.proxy,h=a.extend,i=a.each,j=c.template,k="body",l,m=".k-window",n=".k-window-titlebar",o=".k-window-content",p=".k-resize-handle",q=".k-overlay",r="k-content-frame",s="k-loading",t="k-state-hover",u=":visible",v="hidden",w="cursor",x="open",y="activate",z="deactivate",A="close",B="refresh",C="resize",D="dragstart",E="dragend",F="error",G="overflow",H="zIndex",I=".k-window-actions .k-i-minimize,.k-window-actions .k-i-maximize",J=c.isLocalUrl,O=d.extend({init:function(b,e){var h=this,j,k,o,p,q=!1,r;d.fn.init.call(h,b,e),e=h.options,b=h.element,r=e.content,h.appendTo=a(e.appendTo||document.body),h._animations(),f(r)||(r=e.content={url:r}),b.parent().is(h.appendTo)||(b.is(u)?(k=b.offset(),q=!0):(o=b.css("visibility"),p=b.css("display"),b.css({visibility:v,display:""}),k=b.offset(),b.css({visibility:o,display:p}))),typeof e.visible=="undefined"&&(e.visible=b.is(u)),j=h.wrapper=b.closest(m);if(!b.is(".k-content")||!j[0])b.addClass("k-window-content k-content"),h._createWindow(b,e),j=h.wrapper=b.closest(m),h._dimensions();k&&j.css({top:k.top,left:k.left}),r&&h.refresh(r),h.toFront(),e.visible&&e.modal&&h._overlay(j.is(u)).css({opacity:.5}),j.on({mouseenter:function(){a(this).addClass(t)},mouseleave:function(){a(this).removeClass(t)},click:g(h._windowActionHandler,h)},".k-window-titlebar .k-window-action"),e.resizable&&(j.on("dblclick",n,g(h.toggleMaximization,h)),i("n e s w se sw ne nw".split(" "),function(a,b){j.append(l.resizeHandle(b))}),h.resizing=new P(h)),e.draggable&&(h.dragging=new Q(h)),j.add(j.find(".k-resize-handle,.k-window-titlebar")).on("mousedown",g(h.toFront,h)),h.touchScroller=c.touchScroller(b),a(window).resize(g(h._onDocumentResize,h)),e.visible&&(h.trigger(x),h.trigger(y)),c.notify(h)},_dimensions:function(){var a=this,b=a.wrapper,c=a.element,d=a.options;a.title(d.title),d.width&&b.width(d.width),d.height&&b.height(d.height),i(["minWidth","minHeight","maxWidth","maxHeight"],function(a,b){var e=d[b];e&&e!=Infinity&&c.css(b,e)}),d.visible||b.hide()},_animations:function(){var a=this.options;a.animation===!1&&(a.animation={open:{show:!0,effects:{}},close:{hide:!0,effects:{}}})},setOptions:function(a){d.fn.setOptions.call(this,a),this._animations(),this._dimensions()},events:[x,y,z,A,B,C,D,E,F],options:{name:"Window",animation:{open:{effects:{zoom:{direction:"in"},fade:{direction:"in"}},duration:350,show:!0},close:{effects:{zoom:{direction:"out",properties:{scale:.7}},fade:{direction:"out"}},duration:350,hide:!0}},title:"",actions:["Close"],modal:!1,resizable:!0,draggable:!0,minWidth:90,minHeight:50,maxWidth:Infinity,maxHeight:Infinity},_overlay:function(b){var c=this.appendTo.children(".k-overlay"),d=this.wrapper;c.length||(c=a("<div class='k-overlay' />")),c.insertBefore(d[0]).toggle(b).css(H,parseInt(d.css(H),10)-1);return c},_windowActionHandler:function(b){var c=a(b.target).closest(".k-window-action").find(".k-icon"),d=this;i({"k-i-close":d.close,"k-i-maximize":d.maximize,"k-i-minimize":d.minimize,"k-i-restore":d.restore,"k-i-refresh":d.refresh},function(a,e){if(c.hasClass(a)){b.preventDefault(),e.call(d);return!1}})},center:function(){var b=this.wrapper,c=a(window);b.css({left:c.scrollLeft()+Math.max(0,(c.width()-b.width())/2),top:c.scrollTop()+Math.max(0,(c.height()-b.height())/2)});return this},title:function(a){var b=this,c=b.wrapper,d=b.options,e=c.find(n),f=e.children(".k-window-title"),g=e.outerHeight();if(!arguments.length)return f.text();a===!1?(c.addClass("k-window-titleless"),e.remove()):(e.length||c.prepend(l.titlebar(h(l,d))),c.css("padding-top",g),e.css("margin-top",-g)),f.text(a);return b},content:function(a){var b=this.wrapper.children(o);if(!a)return b.html();b.html(a);return this},open:function(){var b=this,c=b.wrapper,d=b.options,e=d.animation.open,f=c.children(o),g=f.css(G),h;b.trigger(x)||(b.toFront(),d.visible=!0,d.modal&&(h=b._overlay(!1),e.duration?h.kendoStop().kendoAnimate({effects:{fade:{direction:"out",properties:{opacity:.5}}},duration:e.duration,show:!0}):h.css("opacity",.5).show()),c.is(u)||(f.css(G,v),c.show().kendoStop().kendoAnimate({effects:e.effects,duration:e.duration,complete:function(){b.trigger(y),f.css(G,g)}}))),d.isMaximized&&(b._documentScrollTop=a(document).scrollTop(),a("html, body").css(G,v));return b},close:function(){var c=this,d=c.wrapper,e=c.options,f=e.animation.open,g=e.animation.close,h,i,j;d.is(u)&&!c.trigger(A)&&(e.visible=!1,h=M(),i=e.modal&&h.length==1,j=e.modal?c._overlay(!0):a(b),i?g.duration?j.kendoStop().kendoAnimate({effects:{fadeOut:{properties:{opacity:0}}},duration:g.duration,hide:!0}):j.hide():h.length&&L(h.eq(h.length-2))._overlay(!0),d.kendoStop().kendoAnimate({effects:g.effects||f.effects,reverse:g.reverse===!0,duration:g.duration,complete:function(){d.hide(),c.trigger(z)}})),c.options.isMaximized&&(a("html, body").css(G,""),this._documentScrollTop&&this._documentScrollTop>0&&a(document).scrollTop(this._documentScrollTop));return c},toFront:function(){var b=this,c=b.wrapper,d=c[0],e=+c.css(H),f=e;a(m).each(function(b,c){var f=a(c),g=f.css(H),h=f.find(o);isNaN(g)||(e=Math.max(+g,e)),c!=d&&h.find("> ."+r).length>0&&h.append(l.overlay)});if(e==10001||f<e)c.css(H,e+2),b.element.find("> .k-overlay").remove();return b},toggleMaximization:function(){return this[this.options.isMaximized?"restore":"maximize"]()},restore:function(){var b=this,c=b.options,d=b.restoreOptions;if(!!c.isMaximized||!!c.isMinimized){b.wrapper.css({position:"absolute",left:d.left,top:d.top,width:d.width,height:d.height}).find(".k-window-content,.k-resize-handle").show().end().find(".k-window-titlebar .k-i-restore").parent().remove().end().end().find(I).parent().show(),a("html, body").css(G,""),this._documentScrollTop&&this._documentScrollTop>0&&a(document).scrollTop(this._documentScrollTop),c.isMaximized=c.isMinimized=!1,b.trigger(C);return b}},maximize:N("maximize",function(){var b=this,c=b.wrapper,d=c.position();h(b.restoreOptions,{left:d.left,top:d.top}),c.css({left:0,top:0,position:"fixed"}),this._documentScrollTop=a(document).scrollTop(),a("html, body").css(G,v),b.options.isMaximized=!0,b._onDocumentResize()}),minimize:N("minimize",function(){var a=this;a.wrapper.css("height",""),a.element.hide(),a.options.isMinimized=!0}),_onDocumentResize:function(){var b=this,c=b.wrapper,d=a(window);!b.options.isMaximized||(c.css({width:d.width(),height:d.height()-parseInt(c.css("padding-top"),10)}),b.trigger(C))},refresh:function(b){var c=this,d=c.options,e=a(c.element),g,i=d.iframe,k;f(b)||(b={url:b}),b=h({},d.content,b),k=b.url,k?(typeof i=="undefined"&&(i=!J(k)),i?(g=e.find("."+r)[0],g?g.src=k||g.src:e.html(l.contentFrame(h({},d,{content:b})))):c._ajaxRequest(b)):b.template&&c.content(j(b.template)({}));return c},_ajaxRequest:function(b){var c=this,d=b.template,e=c.wrapper.find(".k-window-titlebar .k-i-refresh"),f=setTimeout(function(){e.addClass(s)},100);a.ajax(h({type:"GET",dataType:"html",cache:!1,error:g(function(a,b){c.trigger(F)},c),complete:function(){clearTimeout(f),e.removeClass(s)},success:g(function(a,b){d&&(a=j(d)(a||{})),c.element.html(a),c.trigger(B)},c)},b))},destroy:function(){var a=this,b,c;a.wrapper.remove(),b=M(),c=a.options.modal&&!b.length,c?a._overlay(!1).remove():b.length>0&&L(b.eq(b.length-2))._overlay(!0)},_createWindow:function(){var b=this,c=b.element,d=b.options,e,f;d.scrollable===!1&&c.attr("style","overflow:hidden;"),d.iframe&&c.html(l.contentFrame(d)),f=a(l.wrapper(d)),d.title!==!1&&f.append(l.titlebar(h(l,d))),f.toggleClass("k-rtl",!!b.element.closest(".k-rtl").length),e=c.find("iframe").map(function(a){var b=this.getAttribute("src");this.src="";return b}),f.appendTo(b.appendTo).append(c).find("iframe").each(function(a){this.src=e[a]}),c.show()}});l={wrapper:j("<div class='k-widget k-window' />"),action:j("<a href='\\#' class='k-window-action k-link'><span class='k-icon k-i-#= name.toLowerCase() #'>#= name #</span></a>"),titlebar:j("<div class='k-window-titlebar k-header'>&nbsp;<span class='k-window-title'>#= title #</span><div class='k-window-actions k-header'># for (var i = 0; i < actions.length; i++) { ##= action({ name: actions[i] }) ## } #</div></div>"),overlay:"<div class='k-overlay' />",contentFrame:j("<iframe src='#= content.url #' title='#= title #' frameborder='0' class='"+r+"'>"+"This page requires frames in order to show content"+"</iframe>"),resizeHandle:j("<div class='k-resize-handle k-resize-#= data #'></div>")},P.prototype={dragstart:function(b){var c=this,d=c.owner,e=d.wrapper;c.elementPadding=parseInt(d.wrapper.css("padding-top"),10),c.initialCursorPosition=e.offset(),c.resizeDirection=b.currentTarget.prop("className").replace("k-resize-handle k-resize-",""),c.initialSize={width:e.width(),height:e.height()},c.containerOffset=d.appendTo.offset(),e.append(l.overlay).find(p).not(b.currentTarget).hide(),a(k).css(w,b.currentTarget.css(w))},drag:function(a){var b=this,c=b.owner,d=c.wrapper,e=c.options,f=b.resizeDirection,g=b.containerOffset,h=b.initialCursorPosition,i=b.initialSize,j,k,l,m,n=a.x.location,o=a.y.location;f.indexOf("e")>=0?(j=n-h.left,d.width(K(j,e.minWidth,e.maxWidth))):f.indexOf("w")>=0&&(m=h.left+i.width,j=K(m-n,e.minWidth,e.maxWidth),d.css({left:m-j-g.left,width:j})),f.indexOf("s")>=0?(k=o-h.top-b.elementPadding,d.height(K(k,e.minHeight,e.maxHeight))):f.indexOf("n")>=0&&(l=h.top+i.height,k=K(l-o,e.minHeight,e.maxHeight),d.css({top:l-k-g.top,height:k})),c.trigger(C)},dragend:function(b){var c=this,d=c.owner,e=d.wrapper;e.find(q).remove().end().find(p).not(b.currentTarget).show(),a(k).css(w,""),d.touchScroller&&d.touchScroller.reset(),b.keyCode==27&&e.css(c.initialCursorPosition).css(c.initialSize);return!1}},Q.prototype={dragstart:function(b){var c=this.owner,d=c.element,e=d.find(".k-window-actions"),f=c.appendTo.offset();c.trigger(D),c.initialWindowPosition=c.wrapper.position(),c.startPosition={left:b.x.client-c.initialWindowPosition.left,top:b.y.client-c.initialWindowPosition.top},e.length>0?c.minLeftPosition=e.outerWidth()+parseInt(e.css("right"),10)-d.outerWidth():c.minLeftPosition=20-d.outerWidth(),c.minLeftPosition-=f.left,c.minTopPosition=-f.top,c.wrapper.append(l.overlay).find(p).hide(),a(k).css(w,b.currentTarget.css(w))},drag:function(b){var c=this.owner,d={left:Math.max(b.x.client-c.startPosition.left,c.minLeftPosition),top:Math.max(b.y.client-c.startPosition.top,c.minTopPosition)};a(c.wrapper).css(d)},dragcancel:function(b){var c=this.owner;c.wrapper.find(p).show().end().find(q).remove(),a(k).css(w,""),b.currentTarget.closest(m).css(c.initialWindowPosition)},dragend:function(b){var c=this.owner;c.wrapper.find(p).show().end().find(q).remove(),a(k).css(w,""),c.trigger(E);return!1}},c.ui.plugin(O)})(jQuery);