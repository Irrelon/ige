/*
* Kendo UI Web v2012.2.710 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Web commercial licenses may be obtained at http://kendoui.com/web-license
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3.
* For GPL requirements, please review: http://www.gnu.org/copyleft/gpl.html
*/
;(function(a,b){var c=window.kendo,d=c.support.touch,e=c.ui.Widget,f=a.proxy,g=d?"touchend":"mouseup",h=d?"touchstart":"mousedown",i=d?"touchmove":"mousemove",j="k-state-selected",k="k-state-selecting",l="k-selectable",m="selectstart",n=a(document),o="change",p="k-state-unselecting",q=e.extend({init:function(b,c){var d=this;e.fn.init.call(d,b,c),d._marquee=a("<div class='k-marquee'></div>"),d._lastActive=null,d._moveDelegate=f(d._move,d),d._upDelegate=f(d._up,d),d.element.addClass(l),d.element.delegate("."+l+" "+d.options.filter,h,f(d._down,d))},events:[o],options:{name:"Selectable",filter:">*",multiple:!1},_collide:function(a,b){var c=a.offset(),d={left:c.left,top:c.top,right:c.left+a.outerWidth(),bottom:c.top+a.outerHeight()};return!(d.left>b.right||d.right<b.left||d.top>b.bottom||d.bottom<b.top)},_position:function(a){var b=this._originalPosition,c=b.x,d=b.y,e=a.pageX,f=a.pageY,g;c>e&&(g=e,e=c,c=g),d>f&&(g=f,f=d,d=g);return{top:d,right:e,left:c,bottom:f}},_down:function(b){var d=this,e,f=b.ctrlKey,h=b.shiftKey,o=!d.options.multiple;d._downTarget=a(b.currentTarget),d._shiftPressed=h;if(d._downTarget.closest("."+l)[0]===d.element[0]){n.unbind(g,d._upDelegate).bind(g,d._upDelegate),d._originalPosition={x:b.pageX,y:b.pageY},!o&&a(b.target).is(":not(:input, a)")&&(n.unbind(i,d._moveDelegate).bind(i,d._moveDelegate).unbind(m,!1).bind(m,!1),c.support.touch||b.preventDefault()),o||(a("body").append(d._marquee),d._marquee.css({left:b.clientX+1,top:b.clientY+1,width:0,height:0})),e=d._downTarget.hasClass(j),(o||!f&&!h)&&d.element.find(d.options.filter+"."+j).not(d._downTarget).removeClass(j),f&&(d._lastActive=d._downTarget);if(e&&(f||h))d._downTarget.addClass(j),h||d._downTarget.addClass(p);else if(!c.support.touch||!o)d._downTarget.addClass(k),o&&d._downTarget.hasClass(j)&&d._downTarget.removeClass(k)}},_move:function(b){var c=this,d=c._position(b),e=b.ctrlKey,f,g;c._marquee.css({left:d.left,top:d.top,width:d.right-d.left,height:d.bottom-d.top}),c.element.find(c.options.filter).each(function(){f=a(this),g=c._collide(f,d),g?f.hasClass(j)?c._downTarget[0]!==f[0]&&e&&f.removeClass(j).addClass(p):!f.hasClass(k)&&!f.hasClass(p)&&f.addClass(k):f.hasClass(k)?f.removeClass(k):e&&f.hasClass(p)&&f.removeClass(p).addClass(j)})},_up:function(a){var b=this,d=b.options,e=!d.multiple;n.unbind(m,!1).unbind(i,b._moveDelegate).unbind(g,b._upDelegate),e||b._marquee.remove(),c.support.touch&&e&&b._downTarget.addClass(k),!e&&b._shiftPressed===!0?b.selectRange(b._firstSelectee(),b._downTarget):(b.element.find(d.filter+"."+p).removeClass(p).removeClass(j),b.value(b.element.find(d.filter+"."+k))),b._shiftPressed||(b._lastActive=b._downTarget),b._downTarget=null,b._shiftPressed=!1},value:function(a){var b=this,c=f(b._selectElement,b);if(a)a.each(function(){c(this)}),b.trigger(o,{});else return b.element.find(b.options.filter+"."+j)},_firstSelectee:function(){var a=this,b;if(a._lastActive!==null)return a._lastActive;b=a.value();return b.length>0?b[0]:a.element.find(a.options.filter)},_selectElement:function(b){var c=a(b),d=this.trigger("select",{element:b});c.removeClass(k),d||c.addClass(j)},clear:function(){var a=this;a.element.find(a.options.filter+"."+j).removeClass(j)},selectRange:function(b,c){var d=this,e=!1,g=f(d._selectElement,d),h;b=a(b)[0],c=a(c)[0],d.element.find(d.options.filter).each(function(){h=a(this);if(e)g(this),e=this!==c;else if(this===b)e=b!==c,g(this);else if(this===c){var d=b;b=c,c=d,e=!0,g(this)}else h.removeClass(j)}),d.trigger(o,{})}});c.ui.plugin(q)})(jQuery);