/*
* Kendo UI Web v2012.2.710 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Web commercial licenses may be obtained at http://kendoui.com/web-license
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3.
* For GPL requirements, please review: http://www.gnu.org/copyleft/gpl.html
*/
;(function(a,b){var c=window.kendo,d=c.ui,e=d.List,f=d.Select,g=c.support,h=g.placeholder,i=f.removeFiltersForField,j=c.keys,k=g.touch?"touchend":"click",l="disabled",m="change",n="k-state-default",o="k-state-disabled",p="k-state-focused",q="mousedown",r="select",s="k-state-selected",t="filter",u="accept",v="rebind",w="mouseenter mouseleave",x=null,y=a.proxy,z=f.extend({init:function(b,d){var e=this,g,h;d=a.isArray(d)?{dataSource:d}:d,f.fn.init.call(e,b,d),d=e.options,b=e.element.focus(function(){e.input.focus()}),d.placeholder=d.placeholder||b.attr("placeholder"),e._reset(),e._wrapper(),e._input(),e._popup(),e._accessors(),e._dataSource(),e._enable(),e._cascade(),g=e._inputWrapper,e.input.bind({keydown:y(e._keydown,e),focus:function(){g.addClass(p),e._placeholder(!1)},blur:function(){g.removeClass(p),clearTimeout(e._typing),e.text(e.text()),e._placeholder(),e._blur()}}),e._oldIndex=e.selectedIndex=-1,e._old=e.value(),d.autoBind?e._selectItem():(h=d.text,!h&&b.is(r)&&(h=b.children(":selected").text()),h&&e.input.val(h)),h||e._placeholder(),c.notify(e)},options:{name:"ComboBox",enable:!0,index:-1,autoBind:!0,delay:200,dataTextField:"",dataValueField:"",minLength:0,height:200,highlightFirst:!0,template:"",filter:"none",placeholder:"",suggest:!1,ignoreCase:!0,animation:{}},events:["open","close",m,"select","dataBinding","dataBound"],setOptions:function(a){f.fn.setOptions.call(this,a),this._template(),this._accessors()},current:function(a){var c=this,d=c._current;if(a===b)return d;d&&d.removeClass(s),f.fn.current.call(c,a)},enable:function(a){var b=this,c=b.input.add(b.element),d=b._inputWrapper.unbind(w),e=b._arrow.parent().unbind(k+" "+q);a===!1?(d.removeClass(n).addClass(o),c.attr(l,l)):(d.removeClass(o).addClass(n).bind(w,b._toggleHover),c.removeAttr(l),e.bind(k,function(){b.toggle()}).bind(q,function(a){a.preventDefault()}))},open:function(){var a=this,b=a.dataSource.options.serverFiltering;a.popup.visible()||(!a.ul[0].firstChild||a._state===u&&!b?(a._open=!0,a._state=v,a._selectItem()):(a.popup.open(),a._scroll(a._current)))},refresh:function(){var b=this,d=b.ul[0],e=b.options,f=b.value(),g=b._data(),h=g.length;b.trigger("dataBinding"),d.innerHTML=c.render(b.template,g),b._height(h),b.element.is(r)&&(b._options(g),f&&b._state===v&&(b._state="",b.value(f))),h&&(e.highlightFirst&&b.current(a(d.firstChild)),e.suggest&&b.input.val()&&b.suggest(a(d.firstChild))),b._open&&(b._open=!1,b.toggle(!!h)),b._touchScroller&&b._touchScroller.reset(),b._makeUnselectable(),b._hideBusy(),b.trigger("dataBound")},select:function(a){var c=this;if(a===b)return c.selectedIndex;c._select(a),c._old=c._accessor(),c._oldIndex=c.selectedIndex},search:function(a){a=typeof a=="string"?a:this.text();var b=this,c=a.length,d=b.options,e=d.ignoreCase,f=d.filter,g=d.dataTextField,h,j;clearTimeout(b._typing),c>=d.minLength&&(f==="none"?b._filter(a):(b._open=!0,b._state=t,j=b.dataSource.filter()||{},i(j,g),h=j.filters||[],h.push({value:e?a.toLowerCase():a,field:g,operator:f,ignoreCase:e}),b.dataSource.filter(h)))},suggest:function(a){var c=this,d=c.input[0],f=c.text(),g=e.caret(d),h=c._last,i;if(h==j.BACKSPACE||h==j.DELETE)c._last=b;else{a=a||"",typeof a!="string"&&(i=e.inArray(a[0],c.ul[0]),i>-1?a=c._text(c.dataSource.view()[i]):a=""),g<=0&&(g=f.toLowerCase().indexOf(a.toLowerCase())+1),a?(i=a.toLowerCase().indexOf(f.toLowerCase()),i>-1&&(f+=a.substring(i+f.length))):f=f.substring(0,g);if(f.length!==g||!a)d.value=f,e.selectText(d,g,f.length)}},text:function(a){a=a===null?"":a;var c=this,d=c._text,e=c.input[0],f=c.options.ignoreCase,g=a,h;if(a===b)return e.value;h=c.dataItem();if(!h||d(h)!==a)f&&(g=g.toLowerCase()),c._select(function(a){a=d(a),f&&(a=(a+"").toLowerCase());return a===g}),c.selectedIndex<0&&(c._custom(a),e.value=a)},toggle:function(a){var b=this;b._toggle(a)},value:function(a){var c=this,d;if(a===b)return c._accessor();a!==null&&(a=a.toString());if(!a||!c._valueOnFetch(a))d=c._index(a),d>-1?c.select(d):(c.current(x),c._custom(a),c.text(a),c._placeholder()),c._old=c._accessor(),c._oldIndex=c.selectedIndex},_accept:function(a){var b=this;a&&b.popup.visible()?(b._state===t&&(b._state=u),b._focus(a)):(b.text(b.text()),b._change())},_custom:function(b){var c=this,d=c.element,e=c._option;d.is(r)?(e||(e=c._option=a("<option/>"),d.append(e)),e.text(b),e[0].selected=!0):d.val(b)},_filter:function(a){var c=this,d=c.options,e=c.dataSource,f=d.ignoreCase,g=function(d){var e=c._text(d);if(e!==b){e=e+"";if(e!==""&&a==="")return!1;f&&(e=e.toLowerCase());return e.indexOf(a)===0}};f&&(a=a.toLowerCase());c.ul[0].firstChild?(c._highlight(g)!==-1&&(d.suggest&&c._current&&c.suggest(c._current),c.open()),c._hideBusy()):e.one(m,function(){e.data()[0]&&c.search(a)}).fetch()},_highlight:function(c){var d=this,f;if(c===b||c===null)return-1;c=d._get(c),f=e.inArray(c[0],d.ul[0]),f==-1&&(d.options.highlightFirst&&!d.text()?c=a(d.ul[0].firstChild):c=x),d.current(c);return f},_input:function(){var b=this,c=b.element[0],d=c.tabIndex,e=b.wrapper,f=".k-input",g,i,j=c.name||"";j&&(j='name="'+j+'_input" '),g=e.find(f),g[0]||(e.append('<span unselectable="on" class="k-dropdown-wrap k-state-default"><input '+j+'class="k-input" type="text" autocomplete="off"/><span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s">select</span></span></span>').append(b.element),g=e.find(f)),i=g[0],i.tabIndex=d,i.style.cssText=c.style.cssText,c.maxLength>-1&&(i.maxLength=c.maxLength),g.addClass(c.className).val(c.value).css({width:"100%",height:c.style.height}).show(),h&&g.attr("placeholder",b.options.placeholder),b._focused=b.input=g,b._arrow=e.find(".k-icon"),b._inputWrapper=a(e[0].firstChild)},_keydown:function(a){var b=this,c=a.keyCode,d=b.input;b._last=c,clearTimeout(b._typing),c==j.TAB?(b.text(d.val()),b._state===t&&b.selectedIndex>-1&&(b._state=u)):b._move(a)||b._search()},_placeholder:function(a){if(!h){var c=this,d=c.input,e=c.options.placeholder,f;if(e){f=c.value(),a===b&&(a=!f),d.toggleClass("k-readonly",a);if(!a)if(!f)e="";else return;d.val(e)}}},_search:function(){var a=this;a._typing=setTimeout(function(){var b=a.text();a._prev!==b&&(a._prev=b,a.search(b))},a.options.delay)},_select:function(a){var c=this,d,e,f=c._highlight(a),g=c._data();c.selectedIndex=f,f!==-1&&(c._current.addClass(s),g=g[f],d=c._text(g),e=c._value(g),c._prev=c.input[0].value=d,c._accessor(e!==b?e:d,f),c._placeholder())},_selectItem:function(){var a=this,b=a.options,c=a.dataSource,d=c.filter()||{};i(d,a.options.dataTextField),a.dataSource.one(m,function(){var c=b.value||a.value();c?a.value(c):a.select(b.index),a.trigger("selected")}).filter(d)},_wrapper:function(){var a=this,b=a.element,c;c=b.parent(),c.is("span.k-widget")||(c=b.hide().wrap("<span />").parent()),c[0].style.cssText=b[0].style.cssText,a.wrapper=c.addClass("k-widget k-combobox k-header").addClass(b[0].className).show()}});d.plugin(z)})(jQuery);